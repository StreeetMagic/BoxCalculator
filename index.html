<!doctype html>
<html lang="ru">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Подбор коробки</title>

<h1>Подбор коробки</h1>

<form id="f">
  <label>Длина, мм <input id="l" type="number" min="1" required></label>
  <label>Ширина, мм <input id="w" type="number" min="1" required></label>
  <label>Высота, мм <input id="h" type="number" min="1" required></label>
  <button type="submit">Рассчитать</button>
</form>

<pre id="out">Введите размеры и нажмите «Рассчитать».</pre>

<table id="boxTable" border="1" cellpadding="6">
  <thead>
    <tr><th>#</th><th>Длина, мм</th><th>Ширина, мм</th></tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  // Константы расчёта
  const ADD_EACH_SIDE = 100;
  const ADD_HEIGHT    = 225;
  const MAX_HEIGHT    = 2450;

  // Набор коробок (Длина x Ширина)
  const BOXES = [
    {L:1250, W: 850},
    {L:1800, W: 850},
    {L:1800, W:1225},
    {L:1800, W:1600},
    {L:2350, W: 850},
    {L:2350, W:1225},
    {L:2350, W:1650},
    {L:2350, W:1650},
  ];

  // Рендер таблицы коробок
  (function renderBoxTable(){
    const tbody = document.querySelector('#boxTable tbody');
    tbody.innerHTML = '';
    BOXES.forEach((b, i) => {
      const tr = document.createElement('tr');
      const L = Math.max(b.L,b.W), W = Math.min(b.L,b.W);
      tr.innerHTML = `<td>${i+1}</td><td>${L}</td><td>${W}</td>`;
      tbody.appendChild(tr);
    });
  })();

  const f = document.getElementById('f');
  const out = document.getElementById('out');

  f.addEventListener('submit', (e) => {
    e.preventDefault();
    const srcL = parseInt(document.getElementById('l').value, 10);
    const srcW = parseInt(document.getElementById('w').value, 10);
    const srcH = parseInt(document.getElementById('h').value, 10);

    if (!Number.isFinite(srcL)||!Number.isFinite(srcW)||!Number.isFinite(srcH)||srcL<=0||srcW<=0||srcH<=0){
      showOut('Введите положительные целые значения.');
      return;
    }

    const needL = srcL + ADD_EACH_SIDE;
    const needW = srcW + ADD_EACH_SIDE;
    const needH = roundUpTo(srcH + ADD_HEIGHT, 10);

    if (needH > MAX_HEIGHT) {
      showOut(`Высота ${needH} мм превышает максимум ${MAX_HEIGHT} мм.\nИзмените входные размеры.`);
      return;
    }

    let best = null;
    for (const b of BOXES) {
      if (fits(b, needL, needW)) {
        if (!best || area(b) < area(best) || (area(b) === area(best) && (b.L + b.W) < (best.L + best.W))) {
          best = b;
        }
      }
    }

    if (!best) {
      const outLmin = Math.max(needL, needW);
      const outWmin = Math.min(needL, needW);
      showOut(`Подходящая коробка не найдена.\nМинимум по расчёту: ${outLmin} x ${outWmin} x ${needH} мм (Д x Ш x В).`);
      return;
    }

    const outL = Math.max(best.L, best.W);
    const outW = Math.min(best.L, best.W);
    showOut(`Подходящая коробка: ${outL} x ${outW} x ${needH} мм (Д x Ш x В).`);
  });

  function showOut(text){ out.textContent = text; }
  function area(b){ return b.L*b.W; }
  function fits(b,l,w){ return (b.L>=l&&b.W>=w)||(b.L>=w&&b.W>=l); }
  function roundUpTo(v,step){ if(step<=0)step=10; if(v<=0)return step; const r=v%step; return r===0?v:v+(step-r); }
</script>
</html>
